# Настройка скрипта выгрузки остатков FBO Ozon

## 1. Настройка API Ozon

1. Войдите в личный кабинет Ozon Seller
2. Перейдите в раздел "Настройки" → "API"
3. Создайте новое приложение или используйте существующее
4. Получите:
   - Client ID
   - API ключ

## 2. Настройка Google Apps Script

1. Откройте [Google Apps Script](https://script.google.com)
2. Создайте новый проект
3. Скопируйте код из файла `ozon_fbo_stocks_export.gs`
4. Замените в коде:
   - `YOUR_CLIENT_ID` на ваш Client ID от Ozon
   - `YOUR_API_KEY` на ваш API ключ от Ozon
   - `YOUR_SPREADSHEET_ID` на ID вашей Google Таблицы

## 3. Получение ID Google Таблицы

ID таблицы находится в URL:
```
https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit
```

## 4. Настройка прав доступа

1. В Google Apps Script перейдите в "Сервисы"
2. Добавьте сервис "Google Sheets API"
3. Убедитесь, что у скрипта есть права на редактирование вашей таблицы

## 5. Тестирование

1. Запустите функцию `testOzonConnection()` для проверки подключения
2. Запустите функцию `exportFBOStocks()` для тестовой выгрузки

## 6. Автоматизация

Для ежедневного запуска в 9:00:
```javascript
createDailyTrigger()
```

Для удаления всех триггеров:
```javascript
deleteAllTriggers()
```

## Структура данных в таблице

| Колонка | Описание |
|---------|----------|
| SKU | Артикул товара |
| Название товара | Название товара |
| Артикул | Артикул продавца |
| ID склада | ID склада FBO |
| Название склада | Название склада |
| Остаток | Общий остаток |
| Зарезервировано | Зарезервированный остаток |
| Доступно | Доступный остаток |
| Дата обновления | Время последнего обновления |

## Возможные ошибки

1. **401 Unauthorized** - проверьте Client ID и API ключ
2. **403 Forbidden** - проверьте права доступа к API
3. **Ошибка записи в таблицу** - проверьте ID таблицы и права доступа
